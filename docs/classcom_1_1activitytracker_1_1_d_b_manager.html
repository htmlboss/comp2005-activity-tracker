<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Activity Tracker: com.activitytracker.DBManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-med.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Activity Tracker
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Activity Tracker for MUN COMP-2005</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classcom_1_1activitytracker_1_1_d_b_manager.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pac-methods">Package Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classcom_1_1activitytracker_1_1_d_b_manager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">com.activitytracker.DBManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a39ef296348c7bfacf965b3417655f4e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a39ef296348c7bfacf965b3417655f4e5">createUser</a> (final String name, final String emailAddress, final int DOBYear, final int DOBMonth, final int DOBDay, final User.Sex sex, final float height, final float weight, final <a class="el" href="classcom_1_1activitytracker_1_1_secure_string.html">SecureString</a> securePassword)  throws AssertionError </td></tr>
<tr class="separator:a39ef296348c7bfacf965b3417655f4e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05d79f33ecf2920a67d1b9cf82c079f"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#af05d79f33ecf2920a67d1b9cf82c079f">userExists</a> (final String emailAddress)</td></tr>
<tr class="separator:af05d79f33ecf2920a67d1b9cf82c079f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a195dcdeabdd00facb19d720976dd3f53"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a195dcdeabdd00facb19d720976dd3f53">getUserIDByEmail</a> (final String emailAddress)</td></tr>
<tr class="separator:a195dcdeabdd00facb19d720976dd3f53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f726c054d6c8a6fc3ce629d87f1114"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a20f726c054d6c8a6fc3ce629d87f1114">getUserStringAttribute</a> (final <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a> attribute, final int id)</td></tr>
<tr class="separator:a20f726c054d6c8a6fc3ce629d87f1114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98df66254bec4d74b29cfe468a9fc794"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a98df66254bec4d74b29cfe468a9fc794">getUserFloatAttribute</a> (final <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a> attribute, final int id)</td></tr>
<tr class="separator:a98df66254bec4d74b29cfe468a9fc794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0576baf67b45c7d2d0ba369052e4404e"><td class="memItemLeft" align="right" valign="top">Date&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a0576baf67b45c7d2d0ba369052e4404e">getDateOfBirth</a> (final int id)</td></tr>
<tr class="separator:a0576baf67b45c7d2d0ba369052e4404e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e695c111b877cfd1d918602551f65a1"><td class="memItemLeft" align="right" valign="top">User.Sex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a4e695c111b877cfd1d918602551f65a1">getUserSex</a> (final int id)</td></tr>
<tr class="separator:a4e695c111b877cfd1d918602551f65a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab864b072cc08c0521e80ae1f459ca7"><td class="memItemLeft" align="right" valign="top">byte []&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#aeab864b072cc08c0521e80ae1f459ca7">getUserPassSalt</a> (final int id)</td></tr>
<tr class="separator:aeab864b072cc08c0521e80ae1f459ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab14c61b3f3a17bdea10cab1b5fd9337"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#aab14c61b3f3a17bdea10cab1b5fd9337">getUserLastRID</a> (final int id)</td></tr>
<tr class="separator:aab14c61b3f3a17bdea10cab1b5fd9337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93b7fc4c2d0083e125852d84f087a8d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a93b7fc4c2d0083e125852d84f087a8d3">setUserLastRID</a> (final int id, final int lastRID)</td></tr>
<tr class="separator:a93b7fc4c2d0083e125852d84f087a8d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b742f583167f6ce00eb8415c43fc1c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a05b742f583167f6ce00eb8415c43fc1c">newRun</a> (final int userID, final int year, final int month, final int day, final float duration, final float distance, final float altitude_ascended, final float altitude_descended)</td></tr>
<tr class="separator:a05b742f583167f6ce00eb8415c43fc1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72282377a552ce4ce371abff02e312f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a72282377a552ce4ce371abff02e312f2">setRun</a> (final int rID, final float duration, final float distance, final float altitude_ascended, final float altitude_descended)</td></tr>
<tr class="separator:a72282377a552ce4ce371abff02e312f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a666452f1e5862f90c06b0beb9a9fcfdd"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a666452f1e5862f90c06b0beb9a9fcfdd">getRunFloatAttribute</a> (final <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html">RunAttribute</a> attribute, final int rID)</td></tr>
<tr class="separator:a666452f1e5862f90c06b0beb9a9fcfdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a723ac1c573bacdd0b62894357bd65a9b"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a723ac1c573bacdd0b62894357bd65a9b">runExists</a> (final int rID)</td></tr>
<tr class="separator:a723ac1c573bacdd0b62894357bd65a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pac-methods"></a>
Package Functions</h2></td></tr>
<tr class="memitem:ac1f558ef56fe02d74fe103a473a15bb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#ac1f558ef56fe02d74fe103a473a15bb5">DBManager</a> ()</td></tr>
<tr class="separator:ac1f558ef56fe02d74fe103a473a15bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41df4600bb5901a26a4ea6a7108a70b9"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a41df4600bb5901a26a4ea6a7108a70b9">init</a> (final String dbURL)</td></tr>
<tr class="separator:a41df4600bb5901a26a4ea6a7108a70b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:adef71a18dc05536d80e83311841e1953"><td class="memItemLeft" align="right" valign="top">ResultSet&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#adef71a18dc05536d80e83311841e1953">executeQuery</a> (final String sqlQuery)</td></tr>
<tr class="separator:adef71a18dc05536d80e83311841e1953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382397e2bdf309901d1c80ff66be69b7"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a382397e2bdf309901d1c80ff66be69b7">executeUpdate</a> (final String sqlQuery)</td></tr>
<tr class="separator:a382397e2bdf309901d1c80ff66be69b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ab112f840e3c803b6b28a2f1a15215"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#af9ab112f840e3c803b6b28a2f1a15215">isEmpty</a> ()</td></tr>
<tr class="separator:af9ab112f840e3c803b6b28a2f1a15215"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a064088d13ac09eb147fdc19268771521"><td class="memItemLeft" align="right" valign="top">Connection&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a> = null</td></tr>
<tr class="separator:a064088d13ac09eb147fdc19268771521"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Singleton class for the database. All classes and methods that interact with the database will use a method in this class.</p>
<p>Many times we are faced with the "chicken and egg" problem where we wish to create an object that is populated with information from the database. So the question one faces is, "does the object's constructor query the database (through the <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> class, of course) for each attribute of the object that it wishes to retrieve, or do we directly interact with a <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> method which will then return a <a class="el" href="classcom_1_1activitytracker_1_1_user.html">User</a> or <a class="el" href="classcom_1_1activitytracker_1_1_run.html">Run</a> object, for example?" We have decided to use the former methodology, with <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> methods being as general as possible, and often accepting enum types which then are put into a switch to create the specific SQL query we wish to execute. This works best when all data returned is of the same data type (for example, the Workout class will have three float attributes at the time of writing so we use one method with return type of float for returning Workout attributes). This does not work as well when the object requires data of multiple types &mdash; for example, the <a class="el" href="classcom_1_1activitytracker_1_1_user.html">User</a> class. In this case, we have split the <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> methods into a single method for each attribute being returned.</p>
<p>Polymorphism could theoretically be used here to simply have a return type of Object, however this is not flexible and requires casting <em>all</em> returned data to the correct type in the invoking method. </p>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00025">25</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac1f558ef56fe02d74fe103a473a15bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1f558ef56fe02d74fe103a473a15bb5">&#9670;&nbsp;</a></span>DBManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">com.activitytracker.DBManager.DBManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">package</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a new <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> object.</p>
<p>This should only be called once, from the main program, as <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> is meant to be a <em>singleton</em> class.</p>
<p>This constructor takes no parameters as verification of the SQLite database is done in the <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a41df4600bb5901a26a4ea6a7108a70b9">init()</a> method of this class, which returns information about whether the initialization was successful or not. </p>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00042">42</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a39ef296348c7bfacf965b3417655f4e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39ef296348c7bfacf965b3417655f4e5">&#9670;&nbsp;</a></span>createUser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void com.activitytracker.DBManager.createUser </td>
          <td>(</td>
          <td class="paramtype">final String&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final String&#160;</td>
          <td class="paramname"><em>emailAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>DOBYear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>DOBMonth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>DOBDay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final User.Sex&#160;</td>
          <td class="paramname"><em>sex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final <a class="el" href="classcom_1_1activitytracker_1_1_secure_string.html">SecureString</a>&#160;</td>
          <td class="paramname"><em>securePassword</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> throws AssertionError</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a row for a user to the Users table in the SQLite database for the app.</p>
<p>Requires that the database tables exist and are in the correct format. If the user exists in the database this method raises an AssertionError exception.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>User's name </td></tr>
    <tr><td class="paramname">emailAddress</td><td>User's email address; used to authenticate </td></tr>
    <tr><td class="paramname">DOBYear</td><td>The year the user was born </td></tr>
    <tr><td class="paramname">DOBMonth</td><td>The month the user was born </td></tr>
    <tr><td class="paramname">DOBDay</td><td>The day of month the user was born </td></tr>
    <tr><td class="paramname">sex</td><td>The user's sex; is either <a class="el" href="enumcom_1_1activitytracker_1_1_user_1_1_sex.html#ad3b626a38bd4615eb621d75b939f412d">User.Sex.MALE</a> or <a class="el" href="enumcom_1_1activitytracker_1_1_user_1_1_sex.html#a5c22ece8a4df71ed5202cd492990a752">User.Sex.FEMALE</a> </td></tr>
    <tr><td class="paramname">height</td><td>Floating point number of the user's height in metres </td></tr>
    <tr><td class="paramname">weight</td><td>Floating point number of the user's weight in kilograms </td></tr>
    <tr><td class="paramname">securePassword</td><td>A <a class="el" href="classcom_1_1activitytracker_1_1_secure_string.html">SecureString</a> object containing the user's password, encrypted </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00061">61</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                                                                                        {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#af05d79f33ecf2920a67d1b9cf82c079f">userExists</a>(emailAddress)) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            String sqlQuery = <span class="stringliteral">&quot;INSERT INTO Users (&quot;</span> +</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    <span class="stringliteral">&quot;email_address, &quot;</span> +</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                    <span class="stringliteral">&quot;name, &quot;</span> +</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    <span class="stringliteral">&quot;date_of_birth, &quot;</span> +</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    <span class="stringliteral">&quot;sex, &quot;</span> +</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                    <span class="stringliteral">&quot;height, &quot;</span> +</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                    <span class="stringliteral">&quot;weight,&quot;</span> +</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                    <span class="stringliteral">&quot;password_hash,&quot;</span> +</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    <span class="stringliteral">&quot;password_salt,&quot;</span> +</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="stringliteral">&quot;created_at&quot;</span> +</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    <span class="stringliteral">&quot;) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            byte sexByte = sex.equals(User.Sex.MALE) ? (byte) 1 : (byte) 0;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            java.sql.Date currentTime = <span class="keyword">new</span> java.sql.Date(System.currentTimeMillis());</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            Calendar c = Calendar.getInstance();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            c.set(DOBYear, DOBMonth, DOBDay);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            java.sql.Date dateOfBirth = <span class="keyword">new</span> java.sql.Date(</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    c.get(Calendar.YEAR),</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    c.get(Calendar.MONTH),</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    c.get(Calendar.DAY_OF_MONTH)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            );</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                stmt.setString(1, emailAddress);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                stmt.setString(2, name);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                stmt.setDate(3, dateOfBirth);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                stmt.setByte(4, sexByte);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                stmt.setFloat(5, height);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                stmt.setFloat(6, weight);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                stmt.setString(7, securePassword.toString());</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                stmt.setBytes(8, securePassword.getSalt());</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                stmt.setDate(9, currentTime);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordflow">if</span> (stmt.executeUpdate() != 1) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    System.err.println(<span class="stringliteral">&quot;User not added to database.&quot;</span>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                stmt.close();</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                System.err.println(e.getMessage());</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> AssertionError(<span class="stringliteral">&quot;User with email address &#39;&quot;</span> + emailAddress + <span class="stringliteral">&quot;&#39; already exists.&quot;</span>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_af05d79f33ecf2920a67d1b9cf82c079f"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#af05d79f33ecf2920a67d1b9cf82c079f">com.activitytracker.DBManager.userExists</a></div><div class="ttdeci">boolean userExists(final String emailAddress)</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00124">DBManager.java:124</a></div></div>
<div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adef71a18dc05536d80e83311841e1953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adef71a18dc05536d80e83311841e1953">&#9670;&nbsp;</a></span>executeQuery()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ResultSet com.activitytracker.DBManager.executeQuery </td>
          <td>(</td>
          <td class="paramtype">final String&#160;</td>
          <td class="paramname"><em>sqlQuery</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A wrapper method for processing <em>safe</em> SQL queries.</p>
<p>By safe we mean that the SQL query string is entirely hard-coded in the program source code. In other words, no user input is added. This is an important distinction as the former may leave the application vulnerable to SQL injection.</p>
<p>In such cases, a SQL PreparedStatement should be used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sqlQuery</td><td>The SQL code to be executed. Must be a <em>SELECT</em> statement.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a ResultSet containing the returned row(s) and/or column(s) of the SQL query that was executed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00680">680</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                                          {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        ResultSet res = null;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            Statement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.createStatement();</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            res = stmt.executeQuery(sqlQuery);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            stmt.close();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a382397e2bdf309901d1c80ff66be69b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a382397e2bdf309901d1c80ff66be69b7">&#9670;&nbsp;</a></span>executeUpdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boolean com.activitytracker.DBManager.executeUpdate </td>
          <td>(</td>
          <td class="paramtype">final String&#160;</td>
          <td class="paramname"><em>sqlQuery</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A wrapper method for processing <em>safe</em> SQL queries.</p>
<p>By safe we mean that the SQL query string is entirely hard-coded in the program source code. In other words, no user input is added. This is an important distinction as the former may leave the application vulnerable to SQL injection.</p>
<p>In such cases, a SQL PreparedStatement should be used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sqlQuery</td><td>The SQL code to be executed. Must be an <em>INSERT</em> or <em>UPDATE</em> statement.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a boolean indicating if the query was successful. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00708">708</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                                         {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            Statement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.createStatement();</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            stmt.executeUpdate(sqlQuery);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            stmt.close();</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0576baf67b45c7d2d0ba369052e4404e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0576baf67b45c7d2d0ba369052e4404e">&#9670;&nbsp;</a></span>getDateOfBirth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Date com.activitytracker.DBManager.getDateOfBirth </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the user's date of birth (DOB) from the database.</p>
<p>At the time of writing, this method is only being used in the <a class="el" href="classcom_1_1activitytracker_1_1_user.html">User</a> constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Unique ID used to associate information in the database to this user.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a Date object containing the user's DOB (i.e., year, month, day). </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00298">298</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                             {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        Date DOB;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        java.sql.Date DOBResult;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        ResultSet res;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;SELECT date_of_birth FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            stmt.setInt(1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            DOBResult = res.getDate(<span class="stringliteral">&quot;date_of_birth&quot;</span>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            stmt.close();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        DOB = <span class="keyword">new</span> Date(DOBResult.getYear(), DOBResult.getMonth(), DOBResult.getDay());</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">return</span> DOB;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a666452f1e5862f90c06b0beb9a9fcfdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a666452f1e5862f90c06b0beb9a9fcfdd">&#9670;&nbsp;</a></span>getRunFloatAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float com.activitytracker.DBManager.getRunFloatAttribute </td>
          <td>(</td>
          <td class="paramtype">final <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html">RunAttribute</a>&#160;</td>
          <td class="paramname"><em>attribute</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>rID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves a run's attribute as a floating point number, where applicable, from the database.</p>
<p>This method accepts a <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html">RunAttribute</a> enumeration type to specify what attribute it is returning from the database. Only certain attributes are accepted by this method, namely those that are stored as real values. Attributes stored as other data types should use the appropriate accessor method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attribute</td><td>The attribute that the method is supposed to query the DB for and return the value of. Note that only certain <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html">RunAttribute</a> types are supported in this method.<ul>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html#a7adf133b2a62f1f99ffc2adfb7097ec9">RunAttribute.DURATION</a>, the run's duration is returned.</li>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html#a90ee541e68e458a0bb3f5ea45fd46ec0">RunAttribute.DISTANCE</a>, the run's cumulative distance is returned in metres.</li>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html#abcfe85bf48187d67842a0525c1bcc0af">RunAttribute.ALTITUDE_ASCENDED</a>, the run's cumulative altitude climbed is returned in metres</li>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_run_attribute.html#a337a68867cfdb8ec7a17c318ad8b216b">RunAttribute.ALTITUDE_DESCENDED</a>, the run's cumulative altitude descended is returned in metres </li>
</ul>
</td></tr>
    <tr><td class="paramname">rID</td><td>Unique ID corresponding to the row in the Runs table that we wish to query. If such an ID does not exist, <em>0.0f</em> will be returned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a float containing run attribute as specified by the <em>attribute</em> parameter. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00585">585</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                                                                   {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        ResultSet res;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        PreparedStatement stmt;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        String sqlQuery, columnLabel;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordtype">float</span> attrVal = 0.0f;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">switch</span> (attribute) {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">case</span> DURATION:</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                columnLabel = <span class="stringliteral">&quot;duration&quot;</span>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Runs WHERE id=?&quot;</span>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">case</span> DISTANCE:</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                columnLabel = <span class="stringliteral">&quot;distance&quot;</span>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Runs WHERE id=?&quot;</span>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keywordflow">case</span> ALTITUDE_ASCENDED:</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                columnLabel = <span class="stringliteral">&quot;altitude_ascended&quot;</span>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Runs WHERE id=?&quot;</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">case</span> ALTITUDE_DESCENDED:</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                columnLabel = <span class="stringliteral">&quot;altitude_descended&quot;</span>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Runs WHERE id=?&quot;</span>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">return</span> attrVal;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a723ac1c573bacdd0b62894357bd65a9b">runExists</a>(rID)) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                stmt.setInt(1, rID);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                res = stmt.executeQuery();</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                attrVal = res.getFloat(columnLabel);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                System.err.println(e.getMessage());</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            System.err.println(<span class="stringliteral">&quot;Run &quot;</span> + Integer.toString(rID) + <span class="stringliteral">&quot; does not exist. Cannot get &quot;</span> + columnLabel + <span class="stringliteral">&quot;.&quot;</span>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">return</span> attrVal;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a723ac1c573bacdd0b62894357bd65a9b"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a723ac1c573bacdd0b62894357bd65a9b">com.activitytracker.DBManager.runExists</a></div><div class="ttdeci">boolean runExists(final int rID)</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00636">DBManager.java:636</a></div></div>
<div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98df66254bec4d74b29cfe468a9fc794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98df66254bec4d74b29cfe468a9fc794">&#9670;&nbsp;</a></span>getUserFloatAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float com.activitytracker.DBManager.getUserFloatAttribute </td>
          <td>(</td>
          <td class="paramtype">final <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a>&#160;</td>
          <td class="paramname"><em>attribute</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves a user's attribute in floating point format, when applicable, from the database's Users table.</p>
<p>This method accepts a <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a> enumeration type to specify what attribute it is returning from the database. Only certain attributes are accepted by this method, namely those that are stored as real values. Attributes stored as other data types should use the appropriate accessor method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attribute</td><td>The attribute that the method is supposed to query the DB for and return the value of. Note that only certain <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a> types are supported in this method.<ul>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html#a024206b0dc3261031ef586b3f0fd530c">UserAttribute.WEIGHT</a>, this method retrieves the user's weight from the database.</li>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html#a0a80ca5cce8eb4494c2128bd4291a5b7">UserAttribute.HEIGHT</a>, this method retrieves the user's height from the database. </li>
</ul>
</td></tr>
    <tr><td class="paramname">id</td><td>Unique ID used to associate information in the database to this user.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a floating point number corresponding to the <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a> passed to the method, for the user specified by <em>id</em>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00257">257</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                                                                    {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordtype">float</span> attrVal;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        ResultSet res;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        String sqlQuery, columnLabel;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">switch</span> (attribute) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">case</span> WEIGHT:</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                columnLabel = <span class="stringliteral">&quot;weight&quot;</span>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">case</span> HEIGHT:</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                columnLabel = <span class="stringliteral">&quot;height&quot;</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> AssertionError(<span class="stringliteral">&quot;Incorrect UserAttribute enumeration type passed to method.&quot;</span>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            stmt.setInt(1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            attrVal = res.getFloat(columnLabel);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            stmt.close();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">return</span> 0.0f;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">return</span> attrVal;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a195dcdeabdd00facb19d720976dd3f53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a195dcdeabdd00facb19d720976dd3f53">&#9670;&nbsp;</a></span>getUserIDByEmail()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int com.activitytracker.DBManager.getUserIDByEmail </td>
          <td>(</td>
          <td class="paramtype">final String&#160;</td>
          <td class="paramname"><em>emailAddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>As we are using the user's email address as their identifying attribute, they will supply this when they log in. Hence, as the database relates everything to the user's unique ID, we must retrieve this ID given the email address.</p>
<p>The logic behind this method relies on the database Users table structure making <em>email_address</em> a unique field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">emailAddress</td><td>The user's email address with which they authenticate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a unique integer corresponding to the row in the database's Users table that stores user information for user with email address <em>emailAddress</em>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00155">155</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                                           {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        ResultSet res;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;SELECT id FROM Users WHERE `email_address`=?&quot;</span>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            stmt.setString(1, emailAddress);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            res =  stmt.executeQuery();</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordtype">id</span> = res.getInt(<span class="stringliteral">&quot;id&quot;</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            stmt.close();</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">return</span> id;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aab14c61b3f3a17bdea10cab1b5fd9337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab14c61b3f3a17bdea10cab1b5fd9337">&#9670;&nbsp;</a></span>getUserLastRID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int com.activitytracker.DBManager.getUserLastRID </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the last workout ID that the user added as an integer from the database.</p>
<p>This is used because of the format in which the data is supplied. As the only way to denote a new workout is by recieving (0, 0, 0) in the input file, if the input is <em>not</em> (0, 0, 0), we need to update the previously added workout with the latest line. Hence we need some way of storing an identifier for this workout. As this is unique to each user, we have chosen to store this in the Users table of the database.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Unique ID used to associate information in the database to this user. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An integer corresponding to the last row in the Workouts table that the user created. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00395">395</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                            {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordtype">int</span> rID = 0;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        ResultSet res;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        String columnLabel = <span class="stringliteral">&quot;last_run&quot;</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            stmt.setInt(1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            rID = res.getInt(columnLabel);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            stmt.close();</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">return</span> rID;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeab864b072cc08c0521e80ae1f459ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeab864b072cc08c0521e80ae1f459ca7">&#9670;&nbsp;</a></span>getUserPassSalt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">byte [] com.activitytracker.DBManager.getUserPassSalt </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves a byte array containing the salt used to encrypt the user's password from the database.</p>
<p>This is necessary because to compare a candidate password supplied by a user to a known (encrypted) password stored in the database, we must encrypt the new candidate password using the same salt as was originally used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Unique ID used to associate information in the database to this user.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a byte array containing the user's password encryption salt. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00366">366</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                                {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        byte[] passSalt;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        ResultSet res;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;SELECT password_salt FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            stmt.setInt(1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            passSalt = res.getBytes(<span class="stringliteral">&quot;password_salt&quot;</span>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            stmt.close();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">return</span> passSalt;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e695c111b877cfd1d918602551f65a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e695c111b877cfd1d918602551f65a1">&#9670;&nbsp;</a></span>getUserSex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">User.Sex com.activitytracker.DBManager.getUserSex </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the user's gender from the database.</p>
<p>We have chosen to represent gender in the SQLite database with the data type BIT(1), where 1 denotes male and 0 denotes female. Hence, if the database contains 1 this method returns <a class="el" href="enumcom_1_1activitytracker_1_1_user_1_1_sex.html#ad3b626a38bd4615eb621d75b939f412d">User.Sex.MALE</a> and if the database contains 0 then this method returns <a class="el" href="enumcom_1_1activitytracker_1_1_user_1_1_sex.html#a5c22ece8a4df71ed5202cd492990a752">User.Sex.FEMALE</a>.</p>
<p>At the time of writing, this method is only being used in the <a class="el" href="classcom_1_1activitytracker_1_1_user.html">User</a> constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Unique ID used to associate information in the database to this user.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a <a class="el" href="enumcom_1_1activitytracker_1_1_user_1_1_sex.html">User.Sex</a> enumeration type corresponding to the user's gender. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00333">333</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                             {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        byte sex;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        ResultSet res;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;SELECT sex FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            stmt.setInt(1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            sex = res.getByte(<span class="stringliteral">&quot;sex&quot;</span>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            stmt.close();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> (sex == (byte) 1)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">return</span> User.Sex.MALE;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">return</span> User.Sex.FEMALE;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20f726c054d6c8a6fc3ce629d87f1114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f726c054d6c8a6fc3ce629d87f1114">&#9670;&nbsp;</a></span>getUserStringAttribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String com.activitytracker.DBManager.getUserStringAttribute </td>
          <td>(</td>
          <td class="paramtype">final <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a>&#160;</td>
          <td class="paramname"><em>attribute</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method retrieves a string, varchar, text, or char field, when applicable, from the database's Users table.</p>
<p>This method accepts a <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a> enumeration type to specify what attribute it is returning from the database. Only certain attributes are accepted by this method, namely those that are stored as string-like values. Attributes stored as other data types should use the appropriate accessor method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">attribute</td><td>The attribute that the method is supposed to query the DB for and return the value of. Note that only certain <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html">UserAttribute</a> types are supported in this method.<ul>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html#aa893eac0362a28e73a599ce1ba141d40">UserAttribute.PASSWORD</a>, this method retrieves the user's encrypted password from the database. Typically this will be used in the following sequence of calls:<ol type="1">
<li>User attempts to authenticate with email and password</li>
<li>Their unique ID is retrieved from the database using <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a195dcdeabdd00facb19d720976dd3f53">DBManager::getUserIDByEmail()</a></li>
<li>Their ID is used to retrieve the hash of their password (i.e., this method is called)</li>
<li>The returned string from this method is compared a <a class="el" href="classcom_1_1activitytracker_1_1_secure_string.html">SecureString</a> generated from the candidate password supplied by the user when authenticating.</li>
</ol>
</li>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html#aac51a5dfcaaa9e5304d37d74fc888af4">UserAttribute.NAME</a>, this method retrieves the user's full name from the database (e.g., "John Doe").</li>
<li>When <em>attribute</em> is <a class="el" href="enumcom_1_1activitytracker_1_1_user_attribute.html#a8b9fa2ebf911262dfa24c683ff2a3b9c">UserAttribute.EMAIL_ADDRESS</a>, this method retrieves the user's email address from the database. Note that this is likely somewhat redundant as the user will always be required to authenticate by providing their email address and hence it will already be available to the <a class="el" href="classcom_1_1activitytracker_1_1_user.html">User</a> constructor, which is likely what is invoking this method. </li>
</ul>
</td></tr>
    <tr><td class="paramname">id</td><td>Unique ID used to associate information in the database to this user.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns a string containing attribute specified by the <em>attribute</em> parameter for the user specified by the <em>id</em> parameter. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00203">203</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                                                                      {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        String name;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        ResultSet res;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        String sqlQuery, columnLabel;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">switch</span> (attribute) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">case</span> PASSWORD:</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                columnLabel = <span class="stringliteral">&quot;password_hash&quot;</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">case</span> NAME:</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                columnLabel = <span class="stringliteral">&quot;name&quot;</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">case</span> EMAIL_ADDRESS:</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                columnLabel = <span class="stringliteral">&quot;email_address&quot;</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                sqlQuery = <span class="stringliteral">&quot;SELECT &quot;</span> + columnLabel + <span class="stringliteral">&quot; FROM Users WHERE id=?&quot;</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> AssertionError(<span class="stringliteral">&quot;Incorrect UserAttribute enumeration type passed to method.&quot;</span>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            stmt.setInt(1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            name = res.getString(columnLabel);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            stmt.close();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> name;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a41df4600bb5901a26a4ea6a7108a70b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41df4600bb5901a26a4ea6a7108a70b9">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boolean com.activitytracker.DBManager.init </td>
          <td>(</td>
          <td class="paramtype">final String&#160;</td>
          <td class="paramname"><em>dbURL</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">package</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initializes a connection to the SQLite database.</p>
<p>As no work is done in the <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#ac1f558ef56fe02d74fe103a473a15bb5">DBManager()</a> constructor, this method should be called immediately after creating the single instance of <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> that the application is to use.</p>
<p>This method will attempt to connect to the database file specified by the <em>dbURL</em> parameter, creating the file and all required tables if it/they do not exist. You are encouraged to view the source code of this method for more information about the database schema used.</p>
<p>If all of the above is successful, the method returns True. Otherwise, False is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dbURL</td><td>A file system path to the SQLite database file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns True if the database can be initialized, or False otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00762">762</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                     {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a> = DriverManager.getConnection(<span class="stringliteral">&quot;jdbc:sqlite:&quot;</span> + dbURL);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        System.out.println(<span class="stringliteral">&quot;Opened database successfully.&quot;</span>);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#af9ab112f840e3c803b6b28a2f1a15215">isEmpty</a>()) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            System.out.println(<span class="stringliteral">&quot;Creating tables...&quot;</span>);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="comment">// Create users table</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            String sqlQuery = <span class="stringliteral">&quot;CREATE TABLE USERS (&quot;</span> +</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    <span class="stringliteral">&quot;    id            INTEGER PRIMARY KEY ASC AUTOINCREMENT NOT NULL,&quot;</span> +</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    <span class="stringliteral">&quot;    email_address STRING  NOT NULL UNIQUE ON CONFLICT FAIL,&quot;</span> +</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <span class="stringliteral">&quot;    name          STRING  NOT NULL,&quot;</span> +</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <span class="stringliteral">&quot;    date_of_birth DATE    NOT NULL,&quot;</span> +</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    <span class="stringliteral">&quot;    sex           BIT(1)  NOT NULL,&quot;</span> +</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    <span class="stringliteral">&quot;    height        REAL    NOT NULL,&quot;</span> +</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    <span class="stringliteral">&quot;    weight        REAL    NOT NULL,&quot;</span> +</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    <span class="stringliteral">&quot;    password_hash STRING  NOT NULL,&quot;</span> +</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    <span class="stringliteral">&quot;    password_salt BLOB    NOT NULL,&quot;</span> +</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    <span class="stringliteral">&quot;    last_run  INTEGER NOT NULL DEFAULT 0,&quot;</span> +</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="stringliteral">&quot;    created_at    DATE    NOT NULL&quot;</span> +</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a382397e2bdf309901d1c80ff66be69b7">executeUpdate</a>(sqlQuery)) {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="comment">// Create workouts table</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            sqlQuery = <span class="stringliteral">&quot;CREATE TABLE RUNS (&quot;</span> +</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    <span class="stringliteral">&quot;    id                  INTEGER PRIMARY KEY ASC AUTOINCREMENT NOT NULL,&quot;</span> +</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    <span class="stringliteral">&quot;    user_id             INTEGER NOT NULL REFERENCES USERS (id),&quot;</span> +</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                    <span class="stringliteral">&quot;    date                DATE    NOT NULL,&quot;</span> +</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    <span class="stringliteral">&quot;    duration            REAL    NOT NULL,&quot;</span> + <span class="comment">// seconds</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    <span class="stringliteral">&quot;    distance            REAL    NOT NULL,&quot;</span> + <span class="comment">// metres</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    <span class="stringliteral">&quot;    altitude_ascended   REAL    NOT NULL,&quot;</span> + <span class="comment">// metres</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <span class="stringliteral">&quot;    altitude_descended  REAL    NOT NULL&quot;</span> + <span class="comment">// metres</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a382397e2bdf309901d1c80ff66be69b7">executeUpdate</a>(sqlQuery)) {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="comment">// Create friends table</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            sqlQuery = <span class="stringliteral">&quot;CREATE TABLE FRIENDS (&quot;</span> +</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    <span class="stringliteral">&quot;    id            INTEGER  PRIMARY KEY ASC AUTOINCREMENT NOT NULL,&quot;</span> +</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                    <span class="stringliteral">&quot;    sender        INTEGER  NOT NULL REFERENCES USERS (id),&quot;</span> +</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <span class="stringliteral">&quot;    receiver      INTEGER  REFERENCES USERS (id),&quot;</span> +</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    <span class="stringliteral">&quot;    send_date     DATETIME NOT NULL,&quot;</span> +</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <span class="stringliteral">&quot;    confirm_date  DATETIME DEFAULT NULL&quot;</span> +</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                    <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a382397e2bdf309901d1c80ff66be69b7">executeUpdate</a>(sqlQuery)) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_af9ab112f840e3c803b6b28a2f1a15215"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#af9ab112f840e3c803b6b28a2f1a15215">com.activitytracker.DBManager.isEmpty</a></div><div class="ttdeci">boolean isEmpty()</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00730">DBManager.java:730</a></div></div>
<div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a382397e2bdf309901d1c80ff66be69b7"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a382397e2bdf309901d1c80ff66be69b7">com.activitytracker.DBManager.executeUpdate</a></div><div class="ttdeci">boolean executeUpdate(final String sqlQuery)</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00708">DBManager.java:708</a></div></div>
<div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9ab112f840e3c803b6b28a2f1a15215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ab112f840e3c803b6b28a2f1a15215">&#9670;&nbsp;</a></span>isEmpty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boolean com.activitytracker.DBManager.isEmpty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns a boolean value depending on whether or not the database is populated.</p>
<p>This is done by retrieving tables in the database and checking if this iterator has a next(). If not then there are no tables in the database and we consider it to be empty.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns True if there are tables in the database, False otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00730">730</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                              {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keyword">final</span> DatabaseMetaData dbmd = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.getMetaData();</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="keyword">final</span> String[] types = {<span class="stringliteral">&quot;TABLE&quot;</span>};</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keyword">final</span> ResultSet rs = dbmd.getTables(null, null, <span class="stringliteral">&quot;%&quot;</span>, types);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">return</span> !rs.next();</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05b742f583167f6ce00eb8415c43fc1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05b742f583167f6ce00eb8415c43fc1c">&#9670;&nbsp;</a></span>newRun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int com.activitytracker.DBManager.newRun </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>userID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>month</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>altitude_ascended</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>altitude_descended</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new row in the Runs table with the attributes provided as parameters.</p>
<p>In particular, this method will be called when <a class="el" href="classcom_1_1activitytracker_1_1_run.html#a5dea6f1860431103d553ce770382afe0">Run::newRunDataPoint()</a> receives (0, 0, 0) for (<em>duration</em>, <em>distance</em>, <em>altitude</em>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">userID</td><td>Unique ID used to associate information in the database to this user. </td></tr>
    <tr><td class="paramname">year</td><td>Year that the run was completed. </td></tr>
    <tr><td class="paramname">month</td><td>Month that the run was completed (1-12). </td></tr>
    <tr><td class="paramname">day</td><td>Day that the run was completed (1-31). </td></tr>
    <tr><td class="paramname">duration</td><td>Duration of the run in seconds. </td></tr>
    <tr><td class="paramname">distance</td><td>Distance ran in metres. </td></tr>
    <tr><td class="paramname">altitude_ascended</td><td>Cumulative altitude climbed in metres. </td></tr>
    <tr><td class="paramname">altitude_descended</td><td>Cumulative altitude descended in metres.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a unique integer corresponding to the new row in the SQLite Workouts table by which the new entry can be identified. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00459">459</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                                          {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        java.sql.Date RDate = <span class="keyword">new</span> java.sql.Date(year, month, day);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordtype">int</span> rID = 0;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        ResultSet res;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        String sqlInsertQuery = <span class="stringliteral">&quot;INSERT INTO Runs (&quot;</span> +</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="stringliteral">&quot;user_id,&quot;</span> +</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="stringliteral">&quot;date,&quot;</span> +</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <span class="stringliteral">&quot;duration,&quot;</span> +</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <span class="stringliteral">&quot;distance,&quot;</span> +</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <span class="stringliteral">&quot;altitude_ascended,&quot;</span> +</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="stringliteral">&quot;altitude_descended&quot;</span> +</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="stringliteral">&quot;) VALUES (?, ?, ?, ?, ?, ?)&quot;</span>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        String sqlSelectQuery = <span class="stringliteral">&quot;SELECT id FROM Runs WHERE &quot;</span> +</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="stringliteral">&quot;user_id=? AND &quot;</span> +</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <span class="stringliteral">&quot;date=? AND &quot;</span> +</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="stringliteral">&quot;duration=? AND &quot;</span> +</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <span class="stringliteral">&quot;distance=? AND &quot;</span> +</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="stringliteral">&quot;altitude_ascended=? AND &quot;</span> +</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="stringliteral">&quot;altitude_descended=?&quot;</span>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlInsertQuery);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            stmt.setInt(1, userID);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            stmt.setDate(2, RDate);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            stmt.setFloat(3, duration);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            stmt.setFloat(4, distance);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            stmt.setFloat(5, altitude_ascended);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            stmt.setFloat(6, altitude_descended);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">if</span> (stmt.executeUpdate() != 1) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                System.err.println(<span class="stringliteral">&quot;Run not added to database.&quot;</span>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            }</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            stmt.close();</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="comment">// Pass back in the stuff we just created to get the right row ID</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="comment">// Look at a better way of doing this with OUTPUT clause of INPUT statement</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlSelectQuery);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            stmt.setInt(1, userID);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            stmt.setDate(2, RDate);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            stmt.setFloat(3, duration);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            stmt.setFloat(4, distance);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            stmt.setFloat(5, altitude_ascended);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            stmt.setFloat(6, altitude_descended);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            rID = res.getInt(<span class="stringliteral">&quot;id&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">return</span> rID;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a723ac1c573bacdd0b62894357bd65a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a723ac1c573bacdd0b62894357bd65a9b">&#9670;&nbsp;</a></span>runExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boolean com.activitytracker.DBManager.runExists </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>rID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines if a given run ID exists in the database.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rID</td><td>Unique ID corresponding to the row in the Runs table that we wish to check exists.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This method returns True if the run row with ID <em>WOID</em> exists in the database, or False otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00636">636</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                            {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        ResultSet res;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;SELECT COUNT(*) as count FROM Runs WHERE id=?&quot;</span>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordtype">boolean</span> exists = <span class="keyword">false</span>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            stmt.setInt(1, rID);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            res = stmt.executeQuery();</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordflow">switch</span> (res.getInt(<span class="stringliteral">&quot;count&quot;</span>)) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    exists = <span class="keyword">false</span>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    exists = <span class="keyword">true</span>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    exists = <span class="keyword">true</span>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    System.err.println(<span class="stringliteral">&quot;More than one run for ID &quot;</span> +</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                            Integer.toString(rID) + <span class="stringliteral">&quot;. Something isn&#39;t right.&quot;</span>);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">return</span> exists;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72282377a552ce4ce371abff02e312f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72282377a552ce4ce371abff02e312f2">&#9670;&nbsp;</a></span>setRun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void com.activitytracker.DBManager.setRun </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>rID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>altitude_ascended</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final float&#160;</td>
          <td class="paramname"><em>altitude_descended</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates a run entry in the database as new information becomes available from the input file.</p>
<p>In particular, this method is called when <a class="el" href="classcom_1_1activitytracker_1_1_run.html#a5dea6f1860431103d553ce770382afe0">Run::newRunDataPoint()</a> receives non-(0, 0, 0) input for (<em>duration</em>, <em>distance</em>, <em>altitude</em>).</p>
<p>This method will not be called directly by the application, rather it is called from <a class="el" href="classcom_1_1activitytracker_1_1_run.html#a5dea6f1860431103d553ce770382afe0">Run::newRunDataPoint()</a>. Hence that method will take care of adding/subtracting to/from the current stored values for <em>duration</em>, <em>distance</em>, and <em>altitude</em> &mdash; here we just take the input and put it in the database.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rID</td><td>Unique ID used to identify a run in the database. </td></tr>
    <tr><td class="paramname">duration</td><td>The number of seconds the user's run lasted. </td></tr>
    <tr><td class="paramname">distance</td><td>The cumulative number of metres the user ran. </td></tr>
    <tr><td class="paramname">altitude_ascended</td><td>The cumulative number of metres the user climbed. </td></tr>
    <tr><td class="paramname">altitude_descended</td><td>The cumulative number of metres the user descended. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00533">533</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                                                                             {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;UPDATE Runs SET &quot;</span> +</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <span class="stringliteral">&quot;duration = ?, &quot;</span> +</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                <span class="stringliteral">&quot;distance = ?, &quot;</span> +</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                <span class="stringliteral">&quot;altitude_ascended=?, &quot;</span> +</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="stringliteral">&quot;altitude_descended=? &quot;</span> +</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="stringliteral">&quot;WHERE id=? &quot;</span>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            stmt.setFloat(1, duration);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            stmt.setFloat(2, distance);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            stmt.setFloat(3, altitude_ascended);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            stmt.setFloat(4, altitude_descended);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            stmt.setInt(5, rID);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordtype">int</span> result = stmt.executeUpdate();</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            System.err.println(Integer.toString(result) + <span class="stringliteral">&quot; rows updated in setRun().&quot;</span>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">if</span> (result != 1) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                System.err.println(<span class="stringliteral">&quot;Run not updated in database.&quot;</span>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            stmt.close();</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a93b7fc4c2d0083e125852d84f087a8d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93b7fc4c2d0083e125852d84f087a8d3">&#9670;&nbsp;</a></span>setUserLastRID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void com.activitytracker.DBManager.setUserLastRID </td>
          <td>(</td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">final int&#160;</td>
          <td class="paramname"><em>lastRID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates a user's last run ID in the database.</p>
<p>This method will be used to update the run that a particular user last created. This is used when creating new run as the format of the input file requires that we maintain a record of what run we must update if the next line in the file is <em>not</em> (0, 0, 0).</p>
<p>See <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#aab14c61b3f3a17bdea10cab1b5fd9337">getUserLastRID()</a> for more information on the user of the <em>last_run</em> field in the database.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Unique ID used to associate information in the database to this user. </td></tr>
    <tr><td class="paramname">lastRID</td><td>Integer corresponding to the last row in the Workouts table that the user with ID <em>id</em> created. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00426">426</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                                                {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;UPDATE Users SET last_run=? WHERE id=?&quot;</span>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            stmt.setInt(1, lastRID);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            stmt.setInt(2, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">if</span> (stmt.executeUpdate() != 1) {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                System.err.println(<span class="stringliteral">&quot;User&#39;s last run was not updated correctly.&quot;</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af05d79f33ecf2920a67d1b9cf82c079f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af05d79f33ecf2920a67d1b9cf82c079f">&#9670;&nbsp;</a></span>userExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boolean com.activitytracker.DBManager.userExists </td>
          <td>(</td>
          <td class="paramtype">final String&#160;</td>
          <td class="paramname"><em>emailAddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#af05d79f33ecf2920a67d1b9cf82c079f">DBManager::userExists()</a> method is designed to facilitate the user experience (UX) design choice of users creating one account to the app and logging in with an existing account for future use. This maintains saved (persistent) data and helps enforce the unique constraint placed on the <em>email_address</em> field in the database (again, as users are authenticating using their email address as a user name to identify themselves).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">emailAddress</td><td>The user's email address for which we are checking existence. We use email address here because this is what the user uses to log in to the app. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the user exists in the database, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00124">124</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                                          {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        String sqlQuery = <span class="stringliteral">&quot;SELECT COUNT(*) AS count FROM Users WHERE `email_address`=?&quot;</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordtype">boolean</span> exists = <span class="keyword">false</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            PreparedStatement stmt = <a class="code" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">m_conn</a>.prepareStatement(sqlQuery);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            stmt.setString(1, emailAddress);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            ResultSet res = stmt.executeQuery();</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            exists = res.getInt(<span class="stringliteral">&quot;count&quot;</span>) &gt; 0;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            stmt.close();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">catch</span> (<span class="keyword">final</span> SQLException e) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            System.err.println(e.getMessage());</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">return</span> exists;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="ttc" id="classcom_1_1activitytracker_1_1_d_b_manager_html_a064088d13ac09eb147fdc19268771521"><div class="ttname"><a href="classcom_1_1activitytracker_1_1_d_b_manager.html#a064088d13ac09eb147fdc19268771521">com.activitytracker.DBManager.m_conn</a></div><div class="ttdeci">Connection m_conn</div><div class="ttdef"><b>Definition:</b> <a href="_d_b_manager_8java_source.html#l00032">DBManager.java:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a064088d13ac09eb147fdc19268771521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a064088d13ac09eb147fdc19268771521">&#9670;&nbsp;</a></span>m_conn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Connection com.activitytracker.DBManager.m_conn = null</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The <em>m_conn</em> variable in the <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a> class is initially assigned the value of <em>null</em>.</p>
<p>When <a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html#a41df4600bb5901a26a4ea6a7108a70b9">DBManager::init()</a> is invoked, it is made to be the connection to the database and is subsequently used each time a new SQL statement is created. </p>

<p class="definition">Definition at line <a class="el" href="_d_b_manager_8java_source.html#l00032">32</a> of file <a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>app/src/com/activitytracker/<a class="el" href="_d_b_manager_8java_source.html">DBManager.java</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecom.html">com</a></li><li class="navelem"><a class="el" href="namespacecom_1_1activitytracker.html">activitytracker</a></li><li class="navelem"><a class="el" href="classcom_1_1activitytracker_1_1_d_b_manager.html">DBManager</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
